```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    Zotero LLM Assistant - Python Detection                  │
│                         (Linux AppImage Focus)                              │
└─────────────────────────────────────────────────────────────────────────────┘

                              ┌──────────────┐
                              │ App Launches │
                              └──────┬───────┘
                                     │
                                     v
                        ┌────────────────────────┐
                        │ startBackend() called  │
                        └────────────┬───────────┘
                                     │
                                     v
                      ┌──────────────────────────────┐
                      │ getBackendPath() - async     │
                      │ Calls findPythonInterpreter()│
                      └──────────────┬───────────────┘
                                     │
                 ┌───────────────────┴────────────────────┐
                 │                                        │
             DEV MODE?                               PRODUCTION?
                 │                                        │
                 v                                        v
    ┌─────────────────────────┐          ┌────────────────────────────────┐
    │  findPythonInterpreter  │          │   findPythonInterpreter        │
    │  (System Python only)   │          │   (Bundled → System fallback)  │
    └────────┬────────────────┘          └────────────┬───────────────────┘
             │                                        │
             v                                        v
    ┌─────────────────────────┐          ┌────────────────────────────────┐
    │ Try system Python:      │          │ Try bundled Python first:      │
    │  1. python3             │          │  1. resources/python/bin/py3   │
    │  2. python              │          │  2. resources/python/bin/py    │
    │  3. /usr/bin/python3    │          │  3. resources/python/Scripts/  │
    └────────┬────────────────┘          └────────────┬───────────────────┘
             │                                        │
             │                                        │ Not found?
             │                                        v
             │                           ┌────────────────────────────────┐
             │                           │ Try system Python:             │
             │                           │  1. python3                    │
             │                           │  2. python                     │
             │                           │  3. /usr/bin/python3           │
             │                           │  4. /usr/local/bin/python3     │
             │                           └────────────┬───────────────────┘
             │                                        │
             └────────────────────┬───────────────────┘
                                  │
                 ┌────────────────┴──────────────────┐
                 │                                   │
            Found Python?                        Not Found?
                 │                                   │
                 v                                   v
    ┌─────────────────────────────┐    ┌────────────────────────────────┐
    │ Return Python info:         │    │ Return null                    │
    │  {                          │    │                                │
    │    path: "python3",         │    └────────────┬───────────────────┘
    │    version: "3.12.3",       │                 │
    │    source: "system"         │                 v
    │  }                          │    ┌────────────────────────────────┐
    └────────────┬────────────────┘    │ Show error dialog:             │
                 │                     │                                │
                 v                     │ "Python Not Found"             │
    ┌─────────────────────────────┐    │                                │
    │ Spawn backend process:      │    │ Ubuntu: apt install python3    │
    │                             │    │ Fedora: dnf install python3    │
    │ command: "python3"          │    │ Arch: pacman -S python         │
    │ args: ["-m", "uvicorn",     │    │                                │
    │        "backend.main:app"]  │    │ User can install & try again   │
    │                             │    └────────────────────────────────┘
    └────────────┬────────────────┘
                 │
                 v
    ┌─────────────────────────────┐
    │ Backend starts              │
    │                             │
    │ Logs show:                  │
    │ "Using system Python: py3"  │
    │ "Version: 3.12.3"           │
    │ "Source: system"            │
    └────────────┬────────────────┘
                 │
                 v
    ┌─────────────────────────────┐
    │ Wait for backend health     │
    │ Poll: http://localhost:8000 │
    └────────────┬────────────────┘
                 │
    ┌────────────┴─────────────┐
    │                          │
  Ready?                   Failed?
    │                          │
    v                          v
┌───────────────┐   ┌──────────────────────┐
│ Create Window │   │ Show error & exit    │
│ Load Frontend │   │ or "Continue Anyway" │
│ App Running ✓ │   └──────────────────────┘
└───────────────┘


════════════════════════════════════════════════════════════════════════════
                        KEY IMPROVEMENTS FOR LINUX
════════════════════════════════════════════════════════════════════════════

❌ BEFORE (Broken on Linux):
   • Only looked for "python" (not "python3")
   • Only tried bundled path, crashed if missing
   • No fallback to system Python
   • Unhelpful error messages

✅ AFTER (Works on Linux):
   • Tries "python3" BEFORE "python"
   • Bundled Python (primary)
   • System Python (fallback)
   • Multiple search locations
   • Platform-specific error messages with installation commands

════════════════════════════════════════════════════════════════════════════
                        LINUX-SPECIFIC BEHAVIOR
════════════════════════════════════════════════════════════════════════════

Most Linux distros (Ubuntu, Fedora, Arch, etc.) provide:
  ✓ python3     (standard)
  ✗ python      (often missing)

Some have python-is-python3 package that creates:
  ✓ python3     (real binary)
  ✓ python      (symlink to python3)

Our detection handles BOTH cases automatically!

AppImage mounts at: /tmp/.mount_ZoteroXXXXXX/
  └── resources/
      ├── backend/
      │   └── main.py
      └── python/          ← Bundled Python (if included)
          └── bin/
              ├── python3  ← Preferred
              └── python   ← Symlink

════════════════════════════════════════════════════════════════════════════
```
